<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="zh"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Controller.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">deCOVID</a> &gt; <a href="index.source.html" class="el_package">comp3111.covid</a> &gt; <span class="el_source">Controller.java</span></div><h1>Controller.java</h1><pre class="source lang-java linenums">package comp3111.covid;

import javafx.collections.FXCollections;
import javafx.collections.ObservableList;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.fxml.Initializable;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.scene.chart.XYChart;
import javafx.scene.control.*;
import org.controlsfx.control.CheckComboBox;
import javafx.scene.control.ComboBox;
import org.controlsfx.control.CheckListView;
import javafx.collections.ListChangeListener;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;
import org.apache.commons.csv.CSVRecord;
import org.apache.http.impl.entity.LaxContentLengthStrategy;
import edu.duke.FileResource;
import java.net.URL;
import java.util.ResourceBundle;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.io.IOException;

/**
 * Building on the sample skeleton for 'ui.fxml' Controller Class generated by SceneBuilder 
 */
<span class="fc" id="L31">public class Controller implements Initializable{    </span>
    // Task Zero controller
	    @FXML
	    private Tab tabTaskZero;
	
	    @FXML
	    private TextField textfieldISO;
	
	    @FXML
	    private Button buttonConfirmedDeaths;
	
	    @FXML
	    private TextField textfieldDataset;
	
	    @FXML
	    private Button buttonRateOfVaccination;
	
	    @FXML
	    private Button buttonConfirmedCases;
	
	    @FXML
	    private Tab tabReport1;
	
	    @FXML
	    private Tab tabReport2;
	
	    @FXML
	    private Tab tabReport3;
	
	    @FXML
	    private Tab tabApp1;
	
	    @FXML
	    private Tab tabApp2;
	
	    @FXML
	    private Tab tabApp3;
	
	    @FXML
	    private TextArea textAreaConsole;
	    
	    
    // Task A controller
	    @FXML
	    private DatePicker EndDatePickerA2;
		
		@FXML
	    private TextArea PreviewSelectedCountriesBoxA2;
		
		@FXML
	    private Button PreviewSelectedCountriesButtonA2;
		
	    @FXML
	    private Button buttonCommendableFeaturesA;

	    @FXML
	    private DatePicker StartDatePickerA2;

	    @FXML
	    private Button buttonConfirmedCaseChart;
	    
	    @FXML
	    private Button PreviewSelectedCountriesButtonA1;

	    @FXML
	    private TextArea PreviewSelectedCountriesBoxA1;
	    
	    @FXML
	    private DatePicker DatePickerA1;
		
	    @FXML
	    private Button buttonConfirmedCaseTable;
	    
	    @FXML
	    private CheckComboBox&lt;String&gt; checkComboBoxA1;
	    
	    @FXML
	    private CheckComboBox&lt;String&gt; checkComboBoxA2;
    
    // Task B controller
	    @FXML
	    private ComboBox&lt;String&gt; ContinentB1;
	    
	    @FXML
	    private DatePicker DatePickerB1;
	    
	    @FXML
	    private ListView&lt;String&gt; DisplayCountryB1;
	    
	    @FXML
	    private CheckListView&lt;String&gt; SelectCountryB1;

	    @FXML
	    private Button GenerateTableB1;
	    
	    
	    @FXML
	    private ComboBox&lt;String&gt; ContinentB2;
	    
	    @FXML
	    private DatePicker DatePickerStartB2;
	    
	    @FXML
	    private DatePicker DatePickerEndB2;
	    
	    @FXML
	    private ListView&lt;String&gt; DisplayCountryB2;
	    
	    @FXML
	    private CheckListView&lt;String&gt; SelectCountryB2;

	    @FXML
	    private Button GenerateChartB2;	
	    
	    @FXML
	    private ComboBox&lt;String&gt; AttributeB;
	    
	    @FXML
	    private Button GenerateRelationB;
	
    // Task C controller
	    @FXML
	    private DatePicker DatePickerC1;
	    
	    @FXML
	    private DatePicker DatePickerEndC2;
	    
	    @FXML
	    private DatePicker DatePickerStartC2;
	    
	    @FXML
	    private Button GenerateChartC2;
	    
	    @FXML
	    private Button GenerateTableC1;
	    
	    @FXML
	    private ListView&lt;String&gt; ListCountrySelectedC1;

	    @FXML
	    private ListView&lt;String&gt; ListCountrySelectedC2;
	    
	    @FXML
	    private ComboBox&lt;String&gt; SelectContinentC1;

	    @FXML
	    private ComboBox&lt;String&gt; SelectContinentC2;
	    
	    @FXML
	    private CheckListView&lt;String&gt; SelectCountryC1;

	    @FXML
	    private CheckListView&lt;String&gt; SelectCountryC2;
	    
	    
	    
	
    /**
     * Initialize the scene
     */
    @Override
    public void initialize(URL url, ResourceBundle rb) {
    	// Task A init
			// create a country list
<span class="fc" id="L195">				String Dataset = textfieldDataset.getText();</span>
<span class="fc" id="L196">				final ObservableList&lt;String&gt; CountryList = FXCollections.observableArrayList();</span>
				
<span class="fc" id="L198">				FileResource fr = new FileResource(&quot;dataset/&quot; + Dataset);</span>
				
<span class="fc bfc" id="L200" title="All 2 branches covered.">				for (CSVRecord rec : fr.getCSVParser(true)) {</span>
<span class="fc" id="L201">					String location = rec.get(&quot;location&quot;);</span>
					
<span class="fc bfc" id="L203" title="All 2 branches covered.">					if (!CountryList.contains(location)) {</span>
<span class="fc" id="L204">						CountryList.add(location);</span>
					}
<span class="fc" id="L206">				}</span>


<span class="fc" id="L209">				checkComboBoxA1.getItems().addAll(CountryList);</span>
<span class="fc" id="L210">				checkComboBoxA2.getItems().addAll(CountryList);</span>
			
			// set the valid date input between Mar 1, 2020 and July 20, 2021
<span class="fc" id="L213">				LocalDate minDate = LocalDate.of(2020, 3, 1);</span>
<span class="fc" id="L214">				LocalDate maxDate = LocalDate.of(2021, 7, 20);</span>
<span class="fc" id="L215">				DatePickerA1.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L216">				           new DateCell() {</span>
				               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L218">				                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L219" title="All 4 branches missed.">				                   setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>
<span class="nc" id="L220">				               }});</span>
<span class="fc" id="L221">				DatePickerA1.setValue(minDate);</span>
<span class="fc" id="L222">				StartDatePickerA2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L223">		           new DateCell() {</span>
		               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L225">		                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L226" title="All 4 branches missed.">		                   setDisable(item.isAfter(maxDate.plusDays(-1)) || item.isBefore(minDate));</span>
<span class="nc" id="L227">		               }});</span>
<span class="fc" id="L228">				StartDatePickerA2.setValue(minDate);</span>
<span class="fc" id="L229">				EndDatePickerA2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L230">		           new DateCell() {</span>
		               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L232">		                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L233" title="All 4 branches missed.">		                   setDisable(item.isAfter(maxDate) || item.isBefore(minDate.plusDays(1)));</span>
<span class="nc" id="L234">		               }});</span>
<span class="fc" id="L235">				EndDatePickerA2.setValue(minDate.plusDays(1));</span>
		
		// Task B init
			// create a country-by-continent list
<span class="fc" id="L239">				final ObservableList&lt;String&gt; ContinentList = FXCollections.observableArrayList();</span>
<span class="fc" id="L240">				final ObservableList&lt;String&gt; ContinentFirstCountryList = FXCollections.observableArrayList();</span>
<span class="fc" id="L241">				final ObservableList&lt;ObservableList&lt;String&gt;&gt; CountryByContinentList = FXCollections.observableArrayList();</span>
<span class="fc" id="L242">				final ObservableList&lt;String&gt; AttributeList = FXCollections.observableArrayList(&quot;total_cases_per_million&quot;,&quot;new_cases_per_million&quot;,&quot;icu_patients_per_million&quot;, &quot;hosp_patients_per_million&quot;,&quot;total_tests_per_thousand&quot;,&quot;new_tests_per_thousand&quot;,&quot;new_vaccinations_smoothed_per_million&quot;, &quot;total_vaccinations&quot;,&quot;total_vaccinations_per_hundred&quot;);</span>
				
<span class="fc bfc" id="L244" title="All 2 branches covered.">				for (CSVRecord rec : fr.getCSVParser(true)) {</span>
<span class="fc" id="L245">					String continent = rec.get(&quot;continent&quot;);</span>
<span class="fc" id="L246">					String location = rec.get(&quot;location&quot;);</span>
					// special case handling: when location is continent
<span class="fc bfc" id="L248" title="All 2 branches covered.">					if (continent == &quot;&quot;) {</span>
<span class="fc" id="L249">						continent = rec.get(&quot;location&quot;);</span>
					}
					
<span class="fc bfc" id="L252" title="All 2 branches covered.">					if (!ContinentList.contains(continent)) {</span>
<span class="fc" id="L253">						ContinentList.add(continent);</span>
<span class="fc" id="L254">						ContinentB1.getItems().add(continent);</span>
<span class="fc" id="L255">						ContinentB2.getItems().add(continent);</span>
						
<span class="fc" id="L257">						final ObservableList&lt;String&gt; row = FXCollections.&lt;String&gt;observableArrayList();</span>
<span class="fc" id="L258">						row.add(location);</span>
<span class="fc" id="L259">						CountryByContinentList.add(row);</span>
						
<span class="fc" id="L261">						ContinentFirstCountryList.add(location);</span>
<span class="fc" id="L262">					}</span>
					else {
<span class="fc" id="L264">						int i = ContinentList.indexOf(continent);</span>
<span class="fc bfc" id="L265" title="All 2 branches covered.">						if (!CountryByContinentList.get(i).contains(location)) {</span>
<span class="fc" id="L266">							CountryByContinentList.get(i).add(location);</span>
						}
						
					}
<span class="fc" id="L270">				}</span>
				
<span class="fc bfc" id="L272" title="All 2 branches covered.">				for (int i = 0; i &lt; ContinentList.size(); i++) {</span>
<span class="fc" id="L273">					SelectCountryB1.getItems().addAll(CountryByContinentList.get(i));</span>
<span class="fc" id="L274">					SelectCountryB2.getItems().addAll(CountryByContinentList.get(i));</span>
				}
				
<span class="fc" id="L277">				ContinentB1.setOnAction((e)-&gt;{</span>
<span class="fc" id="L278">					String continent = ContinentB1.getValue();</span>
<span class="fc" id="L279">					int i = ContinentList.indexOf(continent);</span>
<span class="fc" id="L280">					String FirstCountry = ContinentFirstCountryList.get(i);</span>
<span class="fc" id="L281">			    	SelectCountryB1.scrollTo(FirstCountry);</span>
<span class="fc" id="L282">				});</span>
				
<span class="fc" id="L284">				ContinentB2.setOnAction((e)-&gt;{</span>
<span class="fc" id="L285">					String continent = ContinentB2.getValue();</span>
<span class="fc" id="L286">					int i = ContinentList.indexOf(continent);</span>
<span class="fc" id="L287">					String FirstCountry = ContinentFirstCountryList.get(i);</span>
<span class="fc" id="L288">			    	SelectCountryB2.scrollTo(FirstCountry);</span>
<span class="fc" id="L289">				});</span>
				
				//Display countries selected
<span class="fc" id="L292">				SelectCountryB1.getCheckModel().getCheckedItems().addListener(new ListChangeListener&lt;String&gt;() {</span>
				    @Override
				    public void onChanged(ListChangeListener.Change&lt;? extends String&gt; c) {
<span class="fc" id="L295">				        c.next();</span>
<span class="pc bpc" id="L296" title="1 of 2 branches missed.">				        if(c.wasAdded()) {</span>
<span class="fc" id="L297">				        	DisplayCountryB1.getItems().add(c.getAddedSubList().get(0));</span>
<span class="nc bnc" id="L298" title="All 2 branches missed.">				        } else if (c.wasRemoved()) {</span>
<span class="nc" id="L299">				        	DisplayCountryB1.getItems().remove(c.getRemoved().get(0));</span>
				        }
<span class="fc" id="L301">				    }				    </span>
				});
				
<span class="fc" id="L304">				SelectCountryB2.getCheckModel().getCheckedItems().addListener(new ListChangeListener&lt;String&gt;() {</span>
				    @Override
				    public void onChanged(ListChangeListener.Change&lt;? extends String&gt; c) {
<span class="fc" id="L307">				        c.next();</span>
<span class="pc bpc" id="L308" title="1 of 2 branches missed.">				        if(c.wasAdded()) {</span>
<span class="fc" id="L309">				        	DisplayCountryB2.getItems().add(c.getAddedSubList().get(0));</span>
<span class="nc bnc" id="L310" title="All 2 branches missed.">				        } else if (c.wasRemoved()) {</span>
<span class="nc" id="L311">				        	DisplayCountryB2.getItems().remove(c.getRemoved().get(0));</span>
				        }
<span class="fc" id="L313">				    }</span>
				});
				
				//DatePicker
				//Initialize for Task B1
<span class="fc" id="L318">				DatePickerB1.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L319">				           new DateCell() {</span>
				               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L321">				                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L322" title="All 4 branches missed.">				                   setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>
<span class="nc" id="L323">				               }});</span>
				
				//Initialize for Task B2
<span class="fc" id="L326">				DatePickerStartB2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L327">		           new DateCell() {</span>
		               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L329">		                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L330" title="All 4 branches missed.">		                   setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>

<span class="nc" id="L332">		               }});</span>
<span class="fc" id="L333">				DatePickerEndB2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L334">		           new DateCell() {</span>
		               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L336">		                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L337" title="All 4 branches missed.">		                   setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>
<span class="nc" id="L338">		               }});</span>
				//Update minDate &amp; maxDate
<span class="fc" id="L340">				DatePickerStartB2.setOnAction((e)-&gt;{</span>
<span class="fc" id="L341">					DatePickerEndB2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L342">			           new DateCell() {</span>
			               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L344">			                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L345" title="All 4 branches missed.">			                   setDisable(item.isAfter(maxDate) || item.isBefore(DatePickerStartB2.getValue()));</span>
<span class="nc" id="L346">			               }});</span>
<span class="fc" id="L347">				});</span>
<span class="fc" id="L348">				DatePickerEndB2.setOnAction((e)-&gt;{</span>
<span class="fc" id="L349">					DatePickerStartB2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L350">			           new DateCell() {</span>
			               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L352">			                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L353" title="All 4 branches missed.">			                   setDisable(item.isAfter(DatePickerEndB2.getValue()) || item.isBefore(minDate));</span>
<span class="nc" id="L354">			               }});</span>
<span class="fc" id="L355">				});</span>
				
				// Initialize Attribute Selector
<span class="fc" id="L358">				AttributeB.getItems().addAll(AttributeList);</span>
				
				
				
		// Task C init
				// Initialize DatePicker for Task C1 and C2
				// Set date range available for selection
<span class="fc" id="L365">				DatePickerC1.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L366">					new DateCell() {</span>
						@Override
						public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L369">							super.updateItem(item, empty);</span>
<span class="nc bnc" id="L370" title="All 4 branches missed.">							setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>
<span class="nc" id="L371">						}</span>
					}
				);
				
<span class="fc" id="L375">				DatePickerStartC2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L376">					new DateCell() {</span>
						@Override
						public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L379">							super.updateItem(item, empty);</span>
<span class="nc bnc" id="L380" title="All 4 branches missed.">							setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>
<span class="nc" id="L381">						}</span>
					}
				);
				
<span class="fc" id="L385">				DatePickerEndC2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L386">					new DateCell() {</span>
						@Override
						public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L389">							super.updateItem(item, empty);</span>
<span class="nc bnc" id="L390" title="All 4 branches missed.">							setDisable(item.isAfter(maxDate) || item.isBefore(minDate));</span>
<span class="nc" id="L391">						}</span>
					}
				);
				
				// Update available dates such that minDate &lt;= macDate
<span class="fc" id="L396">				DatePickerStartC2.setOnAction((e)-&gt;{</span>
<span class="fc" id="L397">					DatePickerEndC2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L398">			        	new DateCell() {</span>
			        		@Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L400">			        			super.updateItem(item, empty);</span>
<span class="nc bnc" id="L401" title="All 4 branches missed.">			        			setDisable(item.isAfter(maxDate) || item.isBefore(DatePickerStartC2.getValue()));</span>
<span class="nc" id="L402">			        		}</span>
			        	}
					);
<span class="fc" id="L405">				});</span>
				
<span class="fc" id="L407">				DatePickerEndC2.setOnAction((e)-&gt;{</span>
<span class="fc" id="L408">					DatePickerStartC2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L409">			          	new DateCell() {</span>
			          		@Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L411">			          			super.updateItem(item, empty);</span>
<span class="nc bnc" id="L412" title="All 4 branches missed.">			          			setDisable(item.isAfter(DatePickerEndC2.getValue()) || item.isBefore(minDate));</span>
<span class="nc" id="L413">			          		}</span>
			          	}
					);
<span class="fc" id="L416">				});</span>
				
				// Set Country list
<span class="fc" id="L419">				SelectCountryC1.getItems().addAll(CountryList);</span>
<span class="fc" id="L420">				SelectCountryC2.getItems().addAll(CountryList);</span>
				
				// Display selected countries
<span class="fc" id="L423">				SelectCountryC1.getCheckModel().getCheckedItems().addListener(new ListChangeListener&lt;String&gt;() {</span>
				    @Override
				    public void onChanged(ListChangeListener.Change&lt;? extends String&gt; c) {
<span class="fc" id="L426">				        c.next();</span>
<span class="pc bpc" id="L427" title="1 of 2 branches missed.">				        if(c.wasAdded()) {</span>
<span class="fc" id="L428">				        	ListCountrySelectedC1.getItems().add(c.getAddedSubList().get(0));</span>
<span class="nc bnc" id="L429" title="All 2 branches missed.">				        } else if (c.wasRemoved()) {</span>
<span class="nc" id="L430">				        	ListCountrySelectedC1.getItems().remove(c.getRemoved().get(0));</span>
				        }
<span class="fc" id="L432">				    }				    </span>
				});
				
<span class="fc" id="L435">				SelectCountryC2.getCheckModel().getCheckedItems().addListener(new ListChangeListener&lt;String&gt;() {</span>
				    @Override
				    public void onChanged(ListChangeListener.Change&lt;? extends String&gt; c) {
<span class="fc" id="L438">				        c.next();</span>
<span class="pc bpc" id="L439" title="1 of 2 branches missed.">				        if(c.wasAdded()) {</span>
<span class="fc" id="L440">				        	ListCountrySelectedC2.getItems().add(c.getAddedSubList().get(0));</span>
<span class="nc bnc" id="L441" title="All 2 branches missed.">				        } else if (c.wasRemoved()) {</span>
<span class="nc" id="L442">				        	ListCountrySelectedC2.getItems().remove(c.getRemoved().get(0));</span>
				        }
<span class="fc" id="L444">				    }</span>
				});
<span class="fc" id="L446">    }</span>
    
    
    
    
    /**
     *  Task Zero
     *  To be triggered by the &quot;Confirmed Cases&quot; button on the Task Zero Tab 
     *  
     */
    @FXML
    void doConfirmedCases(ActionEvent event) {
<span class="fc" id="L458">    	String iDataset = textfieldDataset.getText();</span>
<span class="fc" id="L459">    	String iISO = textfieldISO.getText();</span>
<span class="fc" id="L460">    	String oReport = DataAnalysis.getConfirmedCases(iDataset, iISO);</span>
<span class="fc" id="L461">    	textAreaConsole.setText(oReport);</span>
<span class="fc" id="L462">    }</span>

  
    /**
     *  Task Zero
     *  To be triggered by the &quot;Confirmed Deaths&quot; button on the Task Zero Tab
     *  
     */
    @FXML
    void doConfirmedDeaths(ActionEvent event) {
<span class="fc" id="L472">    	String iDataset = textfieldDataset.getText();</span>
<span class="fc" id="L473">    	String iISO = textfieldISO.getText();</span>
<span class="fc" id="L474">    	String oReport = DataAnalysis.getConfirmedDeaths(iDataset, iISO);</span>
<span class="fc" id="L475">    	textAreaConsole.setText(oReport);</span>
<span class="fc" id="L476">    }</span>

  
    /**
     *  Task Zero
     *  To be triggered by the &quot;Rate of Vaccination&quot; button on the Task Zero Tab
     *  
     */
    @FXML
    void doRateOfVaccination(ActionEvent event) {
<span class="fc" id="L486">    	String iDataset = textfieldDataset.getText();</span>
<span class="fc" id="L487">    	String iISO = textfieldISO.getText();</span>
<span class="fc" id="L488">    	String oReport = DataAnalysis.getRateOfVaccination(iDataset, iISO);</span>
<span class="fc" id="L489">    	textAreaConsole.setText(oReport);</span>
<span class="fc" id="L490">    }  </span>
    
    
    /**
     *  Task A1
     *  To be triggered by the &quot;Preview Selected Countries&quot; button on the Table A Tab
     *  
     */
    @FXML
    void doPreviewSelectedCountriesA1(ActionEvent event) {
<span class="fc" id="L500">    	ObservableList&lt;String&gt; list = checkComboBoxA1.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L501">    	String oReport = &quot;&quot;;</span>
<span class="fc bfc" id="L502" title="All 2 branches covered.">    	for (Object obj: list) {</span>
<span class="fc" id="L503">    		oReport += String.format(&quot;%s\n&quot;, obj);</span>
<span class="fc" id="L504">    	}</span>
<span class="fc" id="L505">    	PreviewSelectedCountriesBoxA1.setText(oReport);</span>
    	
<span class="fc" id="L507">    }</span>
    
    /**
     *  Task A1
     *  To be triggered by the &quot;Generate table for confirmed cases&quot; button on the Table A Tab
     *  
     */
    @FXML
    void doConfirmedCaseTable(ActionEvent event) {
    	// get input
<span class="fc" id="L517">    	ObservableList&lt;String&gt; list = checkComboBoxA1.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L518">    	LocalDate intersetedDate = DatePickerA1.getValue();</span>
<span class="fc" id="L519">    	String FormattedDate = intersetedDate.format(DateTimeFormatter.ofPattern(&quot;M/d/yyyy&quot;));</span>
<span class="fc" id="L520">    	String dataset = textfieldDataset.getText();</span>

    	// not selected any country
<span class="fc bfc" id="L523" title="All 2 branches covered.">    	if (list.isEmpty()) {</span>
<span class="fc" id="L524">    		textAreaConsole.setText(&quot;Please select country of interest!&quot;);</span>
<span class="fc" id="L525">    		return;</span>
    	}

<span class="fc" id="L528">    	String oReport = TaskA.generateTableA1(dataset, list, intersetedDate);</span>
<span class="fc" id="L529">		textAreaConsole.setText(oReport);</span>
		
<span class="fc" id="L531">		ObservableList&lt;CountryA1&gt; tableList = FXCollections.observableArrayList();</span>
<span class="fc bfc" id="L532" title="All 2 branches covered.">		for (String obj: list) {</span>
<span class="fc" id="L533">    		tableList.add(new CountryA1(dataset, obj, FormattedDate));</span>
<span class="fc" id="L534">    	}</span>

		try {		
<span class="fc" id="L537">			TableA1Controller tableA1Controller = new TableA1Controller(intersetedDate, tableList);</span>
<span class="fc" id="L538">			FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/TableA1.fxml&quot;));</span>
<span class="fc" id="L539">			Stage stage = new Stage();</span>
<span class="fc" id="L540">			stage.setTitle(&quot;Table A1&quot;);</span>
<span class="fc" id="L541">			loader.setController(tableA1Controller);</span>
<span class="fc" id="L542">			stage.setScene(new Scene((VBox) loader.load()));</span>
<span class="fc" id="L543">			stage.show();</span>
<span class="nc" id="L544">		} catch(Exception e) {</span>
<span class="nc" id="L545">			return;</span>
<span class="fc" id="L546">		}</span>
<span class="fc" id="L547">    }</span>
	    
    /**
     *  Task A2
     *  To be triggered by the &quot;Preview Selected Countries&quot; button on the Chart A Tab
     *  
     */
    @FXML
    void doPreviewSelectedCountriesA2(ActionEvent event) {
<span class="fc" id="L556">    	ObservableList&lt;String&gt; list = checkComboBoxA2.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L557">    	String oReport = &quot;&quot;;</span>
<span class="fc bfc" id="L558" title="All 2 branches covered.">    	for (Object obj: list) {</span>
<span class="fc" id="L559">    		oReport += String.format(&quot;%s\n&quot;, obj);</span>
<span class="fc" id="L560">    	}</span>
<span class="fc" id="L561">    	PreviewSelectedCountriesBoxA2.setText(oReport);</span>
<span class="fc" id="L562">    }</span>
    
    /**
     *  Task A2
     *  To be triggered when selected the starting date on the Chart A Tab
     *  
     */
    @FXML
    void doRestrictDateA2(ActionEvent event) {
    	// set the valid date input between Mar 1, 2020 and July 20, 2021
<span class="nc" id="L572">		LocalDate minDate = StartDatePickerA2.getValue();</span>
<span class="nc" id="L573">		LocalDate maxDate = LocalDate.of(2021, 7, 20);</span>
<span class="nc" id="L574">		EndDatePickerA2.setDayCellFactory(d -&gt;</span>
<span class="nc" id="L575">		           new DateCell() {</span>
		               @Override public void updateItem(LocalDate item, boolean empty) {
<span class="nc" id="L577">		                   super.updateItem(item, empty);</span>
<span class="nc bnc" id="L578" title="All 4 branches missed.">		                   setDisable(item.isAfter(maxDate) || item.isBefore(minDate.plusDays(1)));</span>
<span class="nc" id="L579">		               }});</span>
<span class="nc bnc" id="L580" title="All 2 branches missed.">		if(EndDatePickerA2.getValue().isBefore(minDate.plusDays(1))) {</span>
<span class="nc" id="L581">			EndDatePickerA2.setValue(minDate.plusDays(1));</span>
		}
<span class="nc" id="L583">    }</span>
    
    /**
     *  Task A2
     *  To be triggered by the &quot;Generate chart of confirmed cases per 1M&quot; button on the Chart A Tab
     *  
     */
    @FXML
    void doConfirmedCaseChart(ActionEvent event) {
    	// get input
<span class="fc" id="L593">    	ObservableList&lt;String&gt; list = checkComboBoxA2.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L594">    	LocalDate StartingDate = StartDatePickerA2.getValue();</span>
<span class="fc" id="L595">    	LocalDate EndingDate = EndDatePickerA2.getValue();</span>
<span class="fc" id="L596">    	String dataset = textfieldDataset.getText();</span>
<span class="fc" id="L597">    	int duration = (int) (EndingDate.toEpochDay()-StartingDate.toEpochDay()) + 1;</span>
    	
    	// not selected any country
<span class="fc bfc" id="L600" title="All 2 branches covered.">    	if (list.isEmpty()) {</span>
<span class="fc" id="L601">    		textAreaConsole.setText(&quot;Please select country of interest!&quot;);</span>
<span class="fc" id="L602">    		return;</span>
    	}
    		    	
<span class="fc" id="L605">    	String oReport = TaskA.generateChartA2(dataset, list, StartingDate, EndingDate);</span>
<span class="fc" id="L606">    	textAreaConsole.setText(oReport);</span>
    	
<span class="fc" id="L608">    	ObservableList&lt;CountryA2&gt; ChartList = FXCollections.observableArrayList();</span>
<span class="fc" id="L609">    	ChartList.add(new CountryA2(dataset, &quot;&quot;, StartingDate, StartingDate, duration));</span>
<span class="fc bfc" id="L610" title="All 2 branches covered.">		for (String obj: list) {</span>
<span class="fc" id="L611">			ChartList.add(new CountryA2(dataset, obj, StartingDate, EndingDate, duration));</span>
<span class="fc" id="L612">    	}</span>

		try {		
<span class="fc" id="L615">			ChartA2Controller chartA2Controller = new ChartA2Controller(ChartList, duration);</span>
<span class="fc" id="L616">			FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/ChartA2.fxml&quot;));</span>
<span class="fc" id="L617">			Stage stage = new Stage();</span>
<span class="fc" id="L618">			stage.setTitle(&quot;Chart A2&quot;);</span>
<span class="fc" id="L619">			loader.setController(chartA2Controller);</span>
<span class="fc" id="L620">			stage.setScene(new Scene((VBox) loader.load()));</span>
<span class="fc" id="L621">			stage.show();</span>
<span class="nc" id="L622">		} catch(Exception e) {</span>
<span class="nc" id="L623">			return;</span>
<span class="fc" id="L624">		}</span>
<span class="fc" id="L625">    }</span>
    
    /**
     *  Task A Commendable Features
     *  To be triggered by the &quot;Relation between test and confirmed percentage&quot; button on the Table A Tab
     *  
     */
    @FXML
    void doCommendableFeaturesA(ActionEvent event) {
    	// get input
<span class="fc" id="L635">    	LocalDate intersetedDate = DatePickerA1.getValue();</span>
<span class="fc" id="L636">    	String dataset = textfieldDataset.getText();</span>
    		    	
<span class="fc" id="L638">    	String oReport = TaskA.generateComFeatureA(dataset, intersetedDate);</span>
<span class="fc" id="L639">    	textAreaConsole.setText(oReport);</span>

<span class="fc" id="L641">    	ComFeatureA ChartList = new ComFeatureA(dataset, intersetedDate);</span>

		try {		
<span class="fc" id="L644">			ComFeatureAController Controller = new ComFeatureAController(ChartList, ChartList.data.size());</span>
<span class="fc" id="L645">			FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/FeatureA.fxml&quot;));</span>
<span class="fc" id="L646">			Stage stage = new Stage();</span>
<span class="fc" id="L647">			stage.setTitle(&quot;Commendable Feature of Task A&quot;);</span>
<span class="fc" id="L648">			loader.setController(Controller);</span>
<span class="fc" id="L649">			stage.setScene(new Scene((VBox) loader.load()));</span>
<span class="fc" id="L650">			stage.show();</span>
<span class="nc" id="L651">		} catch(Exception e) {</span>
<span class="nc" id="L652">			return;</span>
<span class="fc" id="L653">		}</span>
<span class="fc" id="L654">    }</span>
    
    /**
     *  Task B1
     *  To be triggered by the &quot;Generate Table&quot; button on the Table B Tab
     * 
     */
    @FXML
    void doTableB1(ActionEvent event) {
<span class="fc" id="L663">    	String iDataset = textfieldDataset.getText();</span>
<span class="fc" id="L664">    	ObservableList&lt;String&gt; country = FXCollections.observableArrayList();</span>
    	
<span class="fc" id="L666">    	country = SelectCountryB1.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L667">    	LocalDate date = DatePickerB1.getValue();</span>
    	
<span class="fc bfc" id="L669" title="All 4 branches covered.">    	if (date == null || country.size() == 0) {</span>
<span class="fc" id="L670">    		textAreaConsole.setText(&quot;Please select a valid date and at least one country.&quot;);</span>
    	}
    	else {
    	
<span class="fc" id="L674">	    	ObservableList&lt;DeathsDataB1&gt; DataList = FXCollections.observableArrayList();</span>
<span class="fc bfc" id="L675" title="All 2 branches covered.">	    	for(String item : country) {</span>
<span class="fc" id="L676">	    		DeathsDataB1 data = new DeathsDataB1(iDataset, item, date);</span>
<span class="fc" id="L677">	    		DataList.add(data);</span>
<span class="fc" id="L678">	    	}</span>
    	
    	
	    	try {
<span class="fc" id="L682">	            FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/TableB1.fxml&quot;));</span>
<span class="fc" id="L683">	            Parent root = loader.load();   </span>
	
<span class="fc" id="L685">	            TableB1Controller TableB1 = loader.getController();</span>
<span class="fc" id="L686">	            TableB1.showTable(DataList, date.format(DateTimeFormatter.ofPattern(&quot;MMM dd, yyyy&quot;)));</span>
	    
<span class="fc" id="L688">	            Stage stage = new Stage();</span>
<span class="fc" id="L689">	            stage.setScene(new Scene(root));</span>
<span class="fc" id="L690">	            stage.setTitle(&quot;Table B: Confirmed COVID-19 Deaths&quot;);</span>
<span class="fc" id="L691">	            stage.show();</span>
	    
<span class="nc" id="L693">	        } catch (IOException e) {</span>
<span class="nc" id="L694">	            e.printStackTrace();</span>
<span class="fc" id="L695">	        } 	</span>
    	}
    	
    	
<span class="fc" id="L699">    }</span>
    /**
     *  Task B2
     *  To be triggered by the &quot;Generate Chart&quot; button on the Chart B Tab
     * 
     */
    @FXML
    void doChartB2(ActionEvent event) {
<span class="fc" id="L707">    	String iDataset = textfieldDataset.getText();</span>
<span class="fc" id="L708">    	ObservableList&lt;String&gt; countryList = FXCollections.observableArrayList();</span>
    	
<span class="fc" id="L710">    	countryList = SelectCountryB2.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L711">    	LocalDate StartDate = DatePickerStartB2.getValue();</span>
<span class="fc" id="L712">    	LocalDate EndDate = DatePickerEndB2.getValue();</span>
    	
<span class="pc bpc" id="L714" title="2 of 6 branches missed.">    	if (StartDate == null || EndDate == null || countryList.size() == 0) {</span>
<span class="fc" id="L715">    		textAreaConsole.setText(&quot;Please select a valid period and at least one country.&quot;);</span>
    	}
    	else {
    		
<span class="fc" id="L719">	    	DeathsDataB2 data = new DeathsDataB2();</span>
<span class="fc" id="L720">	        ObservableList&lt;XYChart.Series&lt;String, Double&gt;&gt; series = data.Data(iDataset, countryList, StartDate, EndDate);</span>
<span class="fc" id="L721">	        String text = data.getText();</span>
	    	try {
<span class="fc" id="L723">	            FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/ChartB2.fxml&quot;));</span>
<span class="fc" id="L724">	            Parent root = loader.load();   </span>
	
<span class="fc" id="L726">	            ChartB2Controller ChartB2 = loader.getController();</span>
<span class="fc" id="L727">	            ChartB2.showChart(series, text);</span>
	    
<span class="fc" id="L729">	            Stage stage = new Stage();</span>
<span class="fc" id="L730">	            stage.setScene(new Scene(root));</span>
<span class="fc" id="L731">	            stage.setTitle(&quot;Chart B: Confirmed COVID-19 Deaths (per 1M)&quot;);</span>
<span class="fc" id="L732">	            stage.show(); </span>
<span class="nc" id="L733">	        } catch (IOException e) {</span>
<span class="nc" id="L734">	            e.printStackTrace();</span>
<span class="fc" id="L735">	        } 	</span>
    	}
    	
<span class="fc" id="L738">    }</span>
    
    /** 
     *  Task B Commendable Feature
     *  To be triggered by the &quot;Generate Relation&quot; button on the Table B Tab
     * 
     */
    @FXML
    void doRelationB(ActionEvent event) {
<span class="fc" id="L747">    	String iDataset = textfieldDataset.getText();</span>
<span class="fc" id="L748">    	ObservableList&lt;String&gt; countryList = FXCollections.observableArrayList();</span>
    	
<span class="fc" id="L750">    	countryList = SelectCountryB1.getCheckModel().getCheckedItems();</span>
    	
<span class="fc" id="L752">    	String attribute = AttributeB.getValue();</span>
    	
<span class="fc bfc" id="L754" title="All 4 branches covered.">    	if (attribute == null || countryList.size() == 0) {</span>
<span class="fc" id="L755">    		textAreaConsole.setText(&quot;Please select at least one country and an attribute.&quot;);</span>
    	}
    	else {
    		
<span class="fc" id="L759">    		ComFeatureB data = new ComFeatureB();</span>
<span class="fc" id="L760">	        ObservableList&lt;XYChart.Series&lt;Number, Number&gt;&gt; series = data.Data(iDataset, countryList, attribute);</span>
<span class="fc" id="L761">	        String text = data.getText();</span>
	    	try {
<span class="fc" id="L763">	            FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/FeatureB.fxml&quot;));</span>
<span class="fc" id="L764">	            Parent root = loader.load();   </span>
	
<span class="fc" id="L766">	            ComFeatureBController FeatureB = loader.getController();</span>
<span class="fc" id="L767">	            FeatureB.showChart(series, text, attribute);</span>
	    
<span class="fc" id="L769">	            Stage stage = new Stage();</span>
<span class="fc" id="L770">	            stage.setScene(new Scene(root));</span>
<span class="fc" id="L771">	            stage.setTitle(&quot;Commendable Feature B: Relation between Confirmed Deaths and &quot; + attribute);</span>
<span class="fc" id="L772">	            stage.show(); </span>
<span class="nc" id="L773">	        } catch (IOException e) {</span>
<span class="nc" id="L774">	            e.printStackTrace();</span>
<span class="fc" id="L775">	        } 	</span>
    	}
<span class="fc" id="L777">    }</span>
    
    
    /**
     * Task C1
     * To be triggered by the &quot;Generate Table&quot; button on the Table C Tab
     */
    @FXML
    void doTableC1(ActionEvent event) {
<span class="fc" id="L786">    	String iDataset = textfieldDataset.getText();</span>
    	ObservableList&lt;String&gt; countryList;
    	
<span class="fc" id="L789">    	countryList = SelectCountryC1.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L790">    	LocalDate date = DatePickerC1.getValue();</span>
    	
<span class="fc bfc" id="L792" title="All 4 branches covered.">    	if (date == null || countryList.size() == 0) {</span>
<span class="fc" id="L793">    		textAreaConsole.setText(&quot;Please select a valid date and at least one country.&quot;);</span>
    	}
    	else {
    	
<span class="fc" id="L797">	    	ObservableList&lt;VaccinationRate&gt; DataList = FXCollections.observableArrayList();</span>
<span class="fc bfc" id="L798" title="All 2 branches covered.">	    	for(String country : countryList) {</span>
<span class="fc" id="L799">	    		VaccinationRate data = new VaccinationRate();</span>
<span class="fc" id="L800">	    		data.update(iDataset, country, date);</span>
<span class="fc" id="L801">	    		DataList.add(data);</span>
<span class="fc" id="L802">	    	}</span>
    	
    	
	    	try {
<span class="fc" id="L806">	            FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/TableC1.fxml&quot;));</span>
<span class="fc" id="L807">	            Parent root = loader.load();   </span>
	
<span class="fc" id="L809">	            TableC1Controller TableC1 = loader.getController();</span>
<span class="fc" id="L810">	            TableC1.showTable(DataList, date.format(DateTimeFormatter.ofPattern(&quot;MMM dd, yyyy&quot;)));</span>
	    
<span class="fc" id="L812">	            Stage stage = new Stage();</span>
<span class="fc" id="L813">	            stage.setScene(new Scene(root));</span>
<span class="fc" id="L814">	            stage.setTitle(&quot;Table C: Rate of Vaccination against COVID-19&quot;);</span>
<span class="fc" id="L815">	            stage.show();</span>
	    
<span class="nc" id="L817">	        } catch (IOException e) {</span>
<span class="nc" id="L818">	            e.printStackTrace();</span>
<span class="fc" id="L819">	        }</span>
    	}    	
<span class="fc" id="L821">    }</span>
    
    /**
     * Task C2
     * To be triggered by the &quot;Generate Table&quot; button on the Chart C Tab
     */
    @FXML
    void doChartC2(ActionEvent event) {
<span class="fc" id="L829">    	String iDataset = textfieldDataset.getText();</span>
    	ObservableList&lt;String&gt; countryList;
    	
<span class="fc" id="L832">    	countryList = SelectCountryC2.getCheckModel().getCheckedItems();</span>
<span class="fc" id="L833">    	LocalDate StartDate = DatePickerStartC2.getValue();</span>
<span class="fc" id="L834">    	LocalDate EndDate = DatePickerEndC2.getValue();</span>
    	
<span class="pc bpc" id="L836" title="1 of 6 branches missed.">    	if (StartDate == null || EndDate == null || countryList.size() == 0) {</span>
<span class="fc" id="L837">    		textAreaConsole.setText(&quot;Please select a valid period and at least one country.&quot;);</span>
    	}
    	else {
<span class="fc" id="L840">    		VaccinationRateSeries data = new VaccinationRateSeries(iDataset, countryList, StartDate, EndDate);</span>
<span class="fc" id="L841">    		ObservableList&lt;XYChart.Series&lt;String, Double&gt;&gt; series = data.getSeries();</span>
	    	
	        try {
<span class="fc" id="L844">	            FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/ChartC2.fxml&quot;));</span>
<span class="fc" id="L845">	            Parent root = loader.load();   </span>
	
<span class="fc" id="L847">	            ChartC2Controller ChartC2 = loader.getController();</span>
<span class="fc" id="L848">	            ChartC2.showChart(series);</span>
	    
<span class="fc" id="L850">	            Stage stage = new Stage();</span>
<span class="fc" id="L851">	            stage.setScene(new Scene(root));</span>
<span class="fc" id="L852">	            stage.setTitle(&quot;Chart C: Cumulative Rate of Vaccination against COVID-19&quot;);</span>
<span class="fc" id="L853">	            stage.show(); </span>
<span class="nc" id="L854">	        } catch (IOException e) {</span>
<span class="nc" id="L855">	            e.printStackTrace();</span>
<span class="fc" id="L856">	        } 	</span>
    	}
    	
<span class="fc" id="L859">    }</span>
    
}



</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>